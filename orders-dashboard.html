<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Orders - Krishi Suvidha</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Playfair+Display:wght@600&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="main.css">
</head>

<body>

  <!-- Header -->
  <header class="site-header">
    <div class="container header-inner">
      <a href="index.html" class="brand">Krishi Suvidha</a>
      <nav class="nav">
        <a href="index.html">Home</a>
        <a href="Add-to-cart.html">Shop</a>
        <a href="orders-dashboard.html" style="color:var(--primary)">Orders</a>
        <a href="about-dashboard.html">About</a>
      </nav>
      <div class="cta">
        <button class="btn btn-primary">Refresh</button>
      </div>
    </div>
  </header>

  <section class="hero" style="min-height:250px;">
    <div class="hero-bg"
      style="background-image:url('https://images.unsplash.com/photo-1625246333195-58403cb6c6c3?auto=format&fit=crop&q=80')">
    </div>
    <div class="hero-content">
      <h1>My Orders</h1>
      <p>Track your recent purchases and status.</p>
    </div>
  </section>

  <section class="container" style="padding-top:40px; padding-bottom:80px;">
    <div class="card-panel">
      <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
        <h3>Recent Orders</h3>
        <input type="text" placeholder="Search Order ID..." class="form-input" style="width:200px; margin:0;">
      </div>

      <table class="table-modern">
        <thead>
          <tr>
            <th>Order ID</th>
            <th>Name</th>
            <th>Items / Product</th>
            <th>Amount</th>
            <th>Date</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="orders-body">
          <tr>
            <td colspan="6" class="text-center">Loading orders...</td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <script>
    async function loadOrders() {
      try {
        const res = await fetch('/api/orders');
        const data = await res.json();

        const tbody = document.getElementById('orders-body');
        if (data.length === 0) {
          tbody.innerHTML = '<tr><td colspan="6" class="text-center">No orders found.</td></tr>';
          return;
        }

        tbody.innerHTML = data.map(o => `
            <tr>
                <td><strong>${o.id}</strong></td>
                <td>${o.name || 'Guest'}</td>
                <td>${o.product || (o.items ? o.items.length + ' Items' : 'Unknown')}</td>
                <td>â‚¹${o.amount || 0}</td>
                <td>${o.created_at || 'Just now'}</td>
                <td><span class="badge" style="background:${o.status === 'Pending' ? '#fff7ed' : '#dcfce7'}; color:${o.status === 'Pending' ? '#c2410c' : '#166534'}">${o.status}</span></td>
            </tr>
        `).join('');
      } catch (e) {
        document.getElementById('orders-body').innerHTML = '<tr><td colspan="6" class="text-center" style="color:red">Failed to load orders. Make sure backend is running.</td></tr>';
      }
    }

    document.querySelector('.btn-primary').addEventListener('click', loadOrders);
    loadOrders();
  </script>

  <script type="text/javascript">
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({ pageLanguage: 'en', layout: google.translate.TranslateElement.InlineLayout.SIMPLE }, 'google_translate_element');
    }
  </script>
  <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

</body>

</html>